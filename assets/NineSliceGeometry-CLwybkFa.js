import{b as B,d as O,v as $,B as b,c as p,C as v,T as C,w as x}from"./index-G4nboQjO.js";const E=class T extends B{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(O($,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...T.defaultOptions,...e};const s=e.positions||new Float32Array([0,0,1,0,1,1,0,1]);let o=e.uvs;o||(e.positions?o=new Float32Array(s.length):o=new Float32Array([0,0,1,0,1,1,0,1]));const r=e.indices||new Uint32Array([0,1,2,0,2,3]),n=e.shrinkBuffersToFit,h=new b({data:s,label:"attribute-mesh-positions",shrinkToFit:n,usage:p.VERTEX|p.COPY_DST}),l=new b({data:o,label:"attribute-mesh-uvs",shrinkToFit:n,usage:p.VERTEX|p.COPY_DST}),w=new b({data:r,label:"index-mesh-buffer",shrinkToFit:n,usage:p.INDEX|p.COPY_DST});super({attributes:{aPosition:{buffer:h,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:l,format:"float32x2",stride:2*4,offset:0}},indexBuffer:w,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};E.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let P=E;function F(i){const t=i._stroke,e=i._fill,o=[`div { ${[`color: ${v.shared.setValue(e.color).toHex()}`,`font-size: ${i.fontSize}px`,`font-family: ${i.fontFamily}`,`font-weight: ${i.fontWeight}`,`font-style: ${i.fontStyle}`,`font-variant: ${i.fontVariant}`,`letter-spacing: ${i.letterSpacing}px`,`text-align: ${i.align}`,`padding: ${i.padding}px`,`white-space: ${i.whiteSpace==="pre"&&i.wordWrap?"pre-wrap":i.whiteSpace}`,...i.lineHeight?[`line-height: ${i.lineHeight}px`]:[],...i.wordWrap?[`word-wrap: ${i.breakWords?"break-all":"break-word"}`,`max-width: ${i.wordWrapWidth}px`]:[],...t?[A(t)]:[],...i.dropShadow?[V(i.dropShadow)]:[],...i.cssOverrides].join(";")} }`];return G(i.tagStyles,o),o.join(" ")}function V(i){const t=v.shared.setValue(i.color).setAlpha(i.alpha).toHexa(),e=Math.round(Math.cos(i.angle)*i.distance),s=Math.round(Math.sin(i.angle)*i.distance),o=`${e}px ${s}px`;return i.blur>0?`text-shadow: ${o} ${i.blur}px ${t}`:`text-shadow: ${o} ${t}`}function A(i){return[`-webkit-text-stroke-width: ${i.width}px`,`-webkit-text-stroke-color: ${v.shared.setValue(i.color).toHex()}`,`text-stroke-width: ${i.width}px`,`text-stroke-color: ${v.shared.setValue(i.color).toHex()}`,"paint-order: stroke"].join(";")}const y={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},S={fill:i=>`color: ${v.shared.setValue(i).toHex()}`,breakWords:i=>`word-wrap: ${i?"break-all":"break-word"}`,stroke:A,dropShadow:V};function G(i,t){for(const e in i){const s=i[e],o=[];for(const r in s)S[r]?o.push(S[r](s[r])):y[r]&&o.push(y[r].replace("{{VALUE}}",s[r]));t.push(`${e} { ${o.join(";")} }`)}}class k extends C{constructor(t={}){super(t),this._cssOverrides=[],this.cssOverrides=t.cssOverrides??[],this.tagStyles=t.tagStyles??{}}set cssOverrides(t){this._cssOverrides=t instanceof Array?t:[t],this.update()}get cssOverrides(){return this._cssOverrides}update(){this._cssStyle=null,super.update()}clone(){return new k({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides,tagStyles:{...this.tagStyles}})}get cssStyle(){return this._cssStyle||(this._cssStyle=F(this)),this._cssStyle}addOverride(...t){const e=t.filter(s=>!this.cssOverrides.includes(s));e.length>0&&(this.cssOverrides.push(...e),this.update())}removeOverride(...t){const e=t.filter(s=>this.cssOverrides.includes(s));e.length>0&&(this.cssOverrides=this.cssOverrides.filter(s=>!e.includes(s)),this.update())}set fill(t){typeof t!="string"&&typeof t!="number"&&x("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=t}set stroke(t){t&&typeof t!="string"&&typeof t!="number"&&x("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=t}}const _="http://www.w3.org/2000/svg",W="http://www.w3.org/1999/xhtml";class N{constructor(){this.svgRoot=document.createElementNS(_,"svg"),this.foreignObject=document.createElementNS(_,"foreignObject"),this.domElement=document.createElementNS(W,"div"),this.styleElement=document.createElementNS(W,"style"),this.image=new Image;const{foreignObject:t,svgRoot:e,styleElement:s,domElement:o}=this;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",e.appendChild(t),t.appendChild(s),t.appendChild(o)}}let H;function R(i,t,e,s){s||(s=H||(H=new N));const{domElement:o,styleElement:r,svgRoot:n}=s;o.innerHTML=`<style>${t.cssStyle};</style><div style='padding:0'>${i}</div>`,o.setAttribute("style","transform-origin: top left; display: inline-block"),e&&(r.textContent=e),document.body.appendChild(n);const h=o.getBoundingClientRect();n.remove();const l=t.padding*2;return{width:h.width-l,height:h.height-l}}const X=class U extends P{constructor(...t){super({});let e=t[0]??{};typeof e=="number"&&(O($,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(t){t={...U.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;const e=this.verticesX*this.verticesY,s=[],o=[],r=[],n=this.verticesX-1,h=this.verticesY-1,l=this.width/n,w=this.height/h;for(let a=0;a<e;a++){const c=a%this.verticesX,d=a/this.verticesX|0;s.push(c*l,d*w),o.push(c/n,d/h)}const m=n*h;for(let a=0;a<m;a++){const c=a%n,d=a/n|0,g=d*this.verticesX+c,f=d*this.verticesX+c+1,u=(d+1)*this.verticesX+c,Y=(d+1)*this.verticesX+c+1;r.push(g,f,u,f,Y,u)}this.buffers[0].data=new Float32Array(s),this.buffers[1].data=new Float32Array(o),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};X.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let j=X;const L=class M extends j{constructor(t={}){t={...M.defaultOptions,...t},super({width:t.width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(t){var e,s;this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this._anchorX=(e=t.anchor)==null?void 0:e.x,this._anchorY=(s=t.anchor)==null?void 0:s.y,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,{width:e,height:s,_leftWidth:o,_rightWidth:r,_topHeight:n,_bottomHeight:h,_anchorX:l,_anchorY:w}=this,m=o+r,a=e>m?1:e/m,c=n+h,d=s>c?1:s/c,g=Math.min(a,d),f=l*e,u=w*s;t[0]=t[8]=t[16]=t[24]=-f,t[2]=t[10]=t[18]=t[26]=o*g-f,t[4]=t[12]=t[20]=t[28]=e-r*g-f,t[6]=t[14]=t[22]=t[30]=e-f,t[1]=t[3]=t[5]=t[7]=-u,t[9]=t[11]=t[13]=t[15]=n*g-u,t[17]=t[19]=t[21]=t[23]=s-h*g-u,t[25]=t[27]=t[29]=t[31]=s-u,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,s=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=s*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-s*this._bottomHeight,this.getBuffer("aUV").update()}};L.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let D=L;export{k as H,P as M,D as N,N as a,R as m};
